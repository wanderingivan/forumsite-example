<html xmlns="http://www.w3.org/1999/xhtml"   
   xmlns:h="http://java.sun.com/jsf/html"
   xmlns:f="http://java.sun.com/jsf/core"       	          
   xmlns:ui="http://java.sun.com/jsf/facelets">
   <h:body> 
      <ui:composition template="/WEB-INF/templates/default.xhtml">
        <f:metadata>
    		<f:viewParam name="threadname" value="#{threadBean.threadName}"/>
    		<f:viewParam name="fromComment" value="#{threadBean.fromComment}"/>
    		<f:viewAction action="#{threadBean.load}"/>
		</f:metadata>
		<ui:param name="title" value="#{threadBean.threadName}" />
        <ui:param name="threadName" value="#{threadBean.threadName}"/>
        <ui:param name="category" value="#{threadBean.topic.category}"/>
        <ui:define name="content">
        	<h:messages/>
        	<ui:insert name="actionbar">
        	  <ui:include src="/WEB-INF/templates/actionbar-thread.xhtml"/>
        	</ui:insert>

        	<h:panelGroup rendered="#{not empty threadBean.topic}">  
			  <div class="row">
			    <div class="col-md-10">
			      <div class="panel panel-default forum-panel">
			        <ui:fragment rendered="#{threadBean.topic.comments.size() > 10}">
			          <ui:repeat begin="0" end="#{(threadBean.topic.comments.size()-1)/10}" 
			                     value="#{threadBean.topic.comments}" varStatus="stat">
				        <h:link id="nextPageLink" value="#{(stat.index) + 1}" outcome="loadThread">
			              <f:param name="threadname" value="#{threadBean.threadName}"/>
			              <f:param name="fromComment" value="#{stat.index * 10}"/>
			            </h:link>		        	
			          </ui:repeat>
			        </ui:fragment>

			        <div class="panel-body">

			          <ui:repeat var="comment" value="#{threadBean.topic.comments}" 
			                                   varStatus="stat" 
			                                   begin="#{threadBean.fromComment}" 
			                                   size="#{threadBean.commentsPerPage}">
			           <div class="threadComment">
			           <div class="row">
			             <div class="media forum">
			               <div class="col-md-9">
			                 <div class="media">
			                   <div class="media-heading">
			                     <div class="row">
			                       <div class="col-md-10">
			                     	 <p>#{comment.lastUpdate}</p>
			                       </div>
			                       <div class="col-md-2">
			                     	   <h:link outcome="threadReply" value="#{msg['quote']}" >
			                     	     <f:param name="author" value="#{comment.author.username}"/>
			                     	     <f:param name="message" value="#{comment.message}"/>
			                     	     <f:param name="threadId" value="#{threadBean.topic.id}"/>
			                     	   </h:link>
			                       </div>
			                     </div>
			                   </div>
			                   <div class="media-body" style="padding-top:15px;">
			                     <h5 id="commentId#{stat.index}">#{comment.message}</h5>
			                     <hr/>
			                   </div>
			                 </div>
			               </div>
			               <div class="col-md-3">
			                 <div class="media">
			                   <div class="media-image">
			                     
			                   </div>
			                   <div class="media-body">
			                     <h4>#{comment.author.username}</h4>
			                   </div>
			                 </div>
			               </div>
			             </div>
			           </div>
                       </div>
			          </ui:repeat>
			        </div>
			      </div>
			    </div>
			    <div class="col-md-2">
			    
			    </div>
			  </div>
        	</h:panelGroup>     
        </ui:define>
      </ui:composition>
   </h:body>
</html>