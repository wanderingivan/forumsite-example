<html xmlns="http://www.w3.org/1999/xhtml"   
   xmlns:h="http://java.sun.com/jsf/html"
   xmlns:f="http://java.sun.com/jsf/core"       	          
   xmlns:ui="http://java.sun.com/jsf/facelets">
   <h:body> 
      <ui:composition template="/WEB-INF/templates/default.xhtml">
        <ui:param name="title" value="main"/>
      	<ui:define name="content">
      	  <ui:insert name="action-bar">
      	    <ui:include src="/WEB-INF/templates/actionbar.xhtml"/>
      	  </ui:insert>
      	  <div class="row">
      	    <div class="col-md-10">
      	      <ui:repeat var="category" value="#{categories}">
      	        <div class="panel panel-default forum-panel">
      	          <div class="panel-heading">
      	            <h:link value="#{category}" outcome="category">
      	              <f:param name="category" value="#{category}"/>
      	            </h:link>
      	          </div>
      	          <div class="panel-body">
      	            <ui:repeat var="topic" value="#{index.threads}">
      	              <ui:param name="last" value="#{topic.lastComment}"/>
      	              <h:panelGroup rendered="#{topic.category == category}">
      	                <div class="row">
      	                  <div class="media forum">
      	                    <div class="col-md-7">
      	                      <div class="media">
      	                        <div class="media-image">
      	                          perhaps some gif
      	                          #{topic.category}
      	                        </div>
      	                        <div class="media-body">
      	                          <h:link value="#{topic.name}" outcome="loadThread">
      	                            <f:param name="threadname" value="#{topic.name}"/>
      	                          </h:link>
      	                          <p>
      	                             <h:outputText value="#{msg['topic_by']}"/><h:outputText value="&#160;" /> 
      	                             <h:link value="#{topic.author.username}" outcome="loadUser">
      	                               <f:param name="username" value="#{topic.author.username}"/>
      	                             </h:link>
      	                          </p>
      	                        </div>
      	                      </div>
      	                    </div>
      	                    <div class="col-md-1">
      	                    	<span class="info">1</span>
      	                    </div>
      	                    <div class="col-md-1">
      	                    	<span class="info">#{topic.comments.size()}</span>
      	                    </div>
      	                    <div class="col-md-3">
      	                      <div class="media">
      	                        <div class="media-left"><h:graphicImage style="width:50px;height:50px;" value="/images/#{topic.author.imageName}"/></div>
      	                        <div class="media-body">
								  #{last.message}
      	                          <p><h:link value="#{topic.author.username}" outcome="loadUser">
      	                               <f:param name="username" value="#{topic.author.username}"/>
      	                             </h:link>
      	                          </p>
      	                          <p>
      	                            <i>
      	                              <h:outputText value="#{last.lastUpdate}" >
                                        <f:convertDateTime pattern="dd.MM HH:mm" />
                                      </h:outputText>
                                    </i>
                                  </p>
      	                        </div>
      	                      </div>
      	                    </div>
      	                  </div>
      	                </div>
      	              </h:panelGroup>
      	            </ui:repeat>
      	          </div>
      	        </div>
      	      </ui:repeat>
      	    </div>
      	    <div class="col-md-2">
      	     <ui:fragment rendered="#{!identity.loggedIn}">
              <div class="sideform">
                <h:form id="loginForm">
    			  <div class="loginRow">
        			<h:outputLabel for="name" value="Username" styleClass="loginLabel"/>
        			<h:inputText id="name" value="#{loginCredentials.userId}"/>
    			  </div>

    			  <div class="loginRow">
                    <h:outputLabel for="password" value="Password" styleClass="loginLabel"/>
                    <h:inputSecret id="password" value="#{loginCredentials.password}" redisplay="true"/>
                  </div>

    			  <div class="buttons">
        			<h:commandButton id="login" value="Login" action="#{loginController.login}" styleClass="loginButton"/>
				  </div>
                </h:form>
              </div>
              </ui:fragment>
              <div class="latest">
             	
              	<ui:repeat var="topic" value="#{latest}">
              	  <h5>#{topic.name}</h5>
              	  <p>#{topic.category}</p>
              	  <p>#{topic.author.username}</p>
              	</ui:repeat>
              </div>      	    
      	    </div>
      	  </div>
          <ui:insert name="action-bar">
      	    <ui:include src="/WEB-INF/templates/actionbar.xhtml"/>
      	  </ui:insert>
      	</ui:define>
      </ui:composition>
   </h:body>
</html>